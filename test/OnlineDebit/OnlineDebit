using MaxiPago.Gateway;
using MaxiPago.DataContract;
using MaxiPago.DataContract.Transactional;

namespace MaxiPagoExample {
    class Program {
        static void Main(string[] args) {
            Transaction transaction = new Transaction();
            transaction.Environment = "TEST";

            ResponseBase response = transaction.OnlineDebit(
                "merchantId", // REQUIRED - Merchant ID assigned by maxiPago! //
                 "merchantKey", // REQUIRED - Merchant Key assigned by maxiPago! //
                 "referenceNum", // REQUIRED - Merchant internal order number //
                 "chargeTotal", // REQUIRED - Transaction amount in US format //
                 "processorId", // REQUIRED - Uset '17' for testing //
                 "parametersUrl", // Optional - Passed in GET when customer is redirected bacak //
                 "ipAddress", // Optional //
                 "customerIdExt", // Optional - Merchant customer code //
                );

            if (response.IsTransactionResponse) {

                TransactionResponse result = response as TransactionResponse;

                if (result.ResponseCode == "0") {
                    // Redirect to url below
                    string url = result.OnlineDebitUrl;
                }
                else {
                    // Decline
                }
            }
            else if (response.IsErrorResponse) {
                ErrorResponse result = response as ErrorResponse;
                // Fail
            }
        }
    }
}
